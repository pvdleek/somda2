<script src="https://cdn.ckeditor.com/ckeditor5/41.1.0/super-build/ckeditor.js"></script>
<script src="https://cdn.ckeditor.com/ckeditor5/41.1.0/super-build/translations/nl.js"></script>
<script>
    function SpecialCharactersEmoji(editor) {
        editor.plugins.get('SpecialCharacters').addItems('Emoji', [
            { title: 'Grijnzend gezicht', character: 'ðŸ˜€' },
            { title: 'Lachend gezicht met open mond', character: 'ðŸ˜ƒ' },
            { title: 'Stralend gezicht met open mond en lachende ogen', character: 'ðŸ˜„' },
            { title: 'Grijnzend gezicht met lachende ogen', character: 'ðŸ˜' },
            { title: 'Licht fronzend gezicht', character: 'ðŸ™' },
            { title: 'Lachend gezicht met open mond en gesloten ogen', character: 'ðŸ˜†' },
            { title: 'Lachend gezicht met open mond en zweetdruppel', character: 'ðŸ˜…' },
            { title: 'Gezicht met opengevallen mond', character: 'ðŸ˜²' },
            { title: 'Over de grond rollen van het lachen', character: 'ðŸ¤£' },
            { title: 'Gezicht met tranen van vreugde', character: 'ðŸ˜‚' },
            { title: 'Huilend gezicht', character: 'ðŸ˜¢' },
            { title: 'Enigszins lachend gezicht', character: 'ðŸ™‚' },
            { title: 'Gezicht ondersteboven', character: 'ðŸ™ƒ' },
            { title: 'Knipogend gezicht', character: 'ðŸ˜‰' },
            { title: 'Lachend gezicht', character: 'ðŸ˜Š' },
            { title: 'Lachend gezicht met halo', character: 'ðŸ˜‡' },
            { title: 'Lachend gezicht met stervormige ogen', character: 'ðŸ¤©' },
            { title: 'Gezicht dat van lekker eten geniet', character: 'ðŸ¥²' },
            { title: 'Gezicht met uitgestoken tong', character: 'ðŸ˜›' },
            { title: 'Gezicht met uitgestoken tong en knipoog', character: 'ðŸ˜œ' },
            { title: 'Gek gezicht', character: 'ðŸ¤ª' },
            { title: 'Gezicht met uitgestoken tong en dichtgeknepen ogen', character: 'ðŸ˜' },
            { title: 'Gezicht met geld in de mond', character: 'ðŸ¤‘' },
            { title: 'Gezicht met handen uitgestoken voor een knuffel', character: 'ðŸ¤—' },
            { title: 'Gezicht met open ogen en hand over de mond', character: 'ðŸ¤­' },
            { title: 'Tot stilte manend gezicht', character: 'ðŸ¤«' },
            { title: 'Nadenkend gezicht', character: 'ðŸ¤”' },
            { title: 'Gezicht met een rits als mond', character: 'ðŸ¤' },
            { title: 'Gezicht met opgetrokken wenkbrauw', character: 'ðŸ¤¨' },
            { title: 'Neutraal gezicht', character: 'ðŸ˜' },
            { title: 'Boos gezicht', character: 'ðŸ˜’' },
            { title: 'Duim omhoog', character: 'ðŸ‘' },
            { title: 'Duim omlaag', character: 'ðŸ‘' },
            { title: 'Gloeilamp', character: 'ðŸ’¡' },
        ], { label: 'Emoticons' });
    }

    CKEDITOR.ClassicEditor
        .create(document.querySelector('#text_editor'), {
            toolbar: {
                items: [
                    'undo', 'redo', '|',
                    'bold', 'italic', 'strikethrough', 'underline', 'horizontalLine', 'removeFormat', '|',
                    'link', '|',
                    'numberedList', 'bulletedList', 'blockQuote', '|',
                    'specialCharacters', '|',
                    'sourceEditing'
                ],
                shouldNotGroupWhenFull: true
            },
            language: 'nl',
            link: {
                decorators: {
                    addTargetToExternalLinks: true,
                    defaultProtocol: 'https://'
                }
            },
            placeholder: 'Schrijf hier je bericht...',
            plugins: [
                'Essentials',
                'Paragraph',
                'Bold',
                'Italic',
                'Strikethrough',
                'Underline',
                'HorizontalLine',
                'RemoveFormat',
                'Link',
                'List',
                'BlockQuote',
                'SpecialCharacters',
                'SpecialCharactersEssentials',
                SpecialCharactersEmoji,
                'SourceEditing'
            ]
        })
        .then(editor => {
            window.editor = editor;
            editor.setData("{{ form.text.vars.value|replace({'"': "'", "\n": '', "\r": '', "\t": ''})|raw }}");
        });

    $(document).ready(function() {
        window.editor.focus();
        window.editor.model.change(writer => {
            writer.setSelection(writer.createPositionAt(editor.model.document.getRoot(), 'end'));
        });
    });
</script>
